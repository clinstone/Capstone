ssh -i "SparkAWS.pem" ubuntu@ec2-34-214-184-17.us-west-2.compute.amazonaws.com



localhost:5432:*:mimicuser:TokyoP@rkDr!pgolf

chmod 600 .pgpass

psql 'dbname=mimic user=mimicuser options=--search_path=mimiciii'

psql -U mimicuser -d mimic -h localhost options=--search_path=mimiciii

psql -U ubuntu -d postgres

ssh -i "SparkAWS.pem" ubuntu@ec2-54-245-134-94.us-west-2.compute.amazonaws.com

createuser -P -s -e -d ubuntu (password mimic) 

psql -U ubuntu -d postgres

CREATE DATABASE mimic OWNER ubuntu;

psql 'dbname=mimic user=ubuntu options=--search_path=mimiciii' -f postgres_create_tables.sql

psql 'dbname=mimic user=ubuntu options=--search_path=mimiciii' -f postgres_load_data.sql -v mimic_data_dir=/home/ubuntu/MIMICdata/

nohup psql 'dbname=mimic user=ubuntu options=--search_path=mimiciii' -f postgres_load_data.sql -v mimic_data_dir=/home/ubuntu/MIMICdata/ > myprogram.out 2>myprogram.err &


nohup psql 'dbname=mimic1 user=ubuntu options=--search_path=mimiciii' -f postgres_add_indexes.sql > index2.out 2>index2.err &

psql 'dbname=mimic user=ubuntu options=--search_path=mimiciii' -f postgres_add_indexes.sql

psql 'dbname=mimic1 user=ubuntu options=--search_path=mimiciii' -f postgres_checks.sql

psql 'dbname=mimic1 user=ubuntu options=--search_path=mimiciii'

grant select on all tables in schema mimiciii to ubuntu;
grant usage on schema mimiciii to ubuntu;
grant connect on database mimic1 to ubuntu;

nohup psql 'dbname=mimic1 user=ubuntu options=--search_path=mimiciii' -f make-concepts.sql > concepts.out 2>concepts.err &

sudo mkdir /home/ubuntu/MIMICmaterialized/

sudo chown postgres /home/ubuntu/MIMICmaterialized/

COPY (SELECT * FROM oasis) TO '/home/ubuntu/MIMICmaterialized/oasis.csv' DELIMITER ',' CSV HEADER;
COPY (SELECT * FROM apsiii) TO '/home/ubuntu/MIMICmaterialized/apsiii.csv' DELIMITER ',' CSV HEADER;
COPY (SELECT * FROM sapsii) TO '/home/ubuntu/MIMICmaterialized/sapsii.csv' DELIMITER ',' CSV HEADER;

sudo growpart /dev/nvme0n1 1

sudo resize2fs /dev/nvme0n1p1

tail -n 100 index2.out

tail -n 100 index2.err





